---
tag: CVE
---
# References
[](https://nvd.nist.gov/vuln/detail/cve-2019-7609)[https://nvd.nist.gov/vuln/detail/cve-2019-7609](https://nvd.nist.gov/vuln/detail/cve-2019-7609)
[](https://github.com/mpgn/CVE-2019-7609)[https://github.com/mpgn/CVE-2019-7609](https://github.com/mpgn/CVE-2019-7609)

# Enumerate
## Cài đặt phiên bản chứa lỗi và search Description
- ./start.sh
``` d
version: "3.0"
services:
  elasticsearch:
    container_name: es-container
    image: docker.elastic.co/elasticsearch/elasticsearch:6.6.0
    environment:
      - xpack.security.enabled=false
      - "discovery.type=single-node"
    networks:
      - es-net
    ports:
      - 9200:9200
  kibana:
    container_name: kb-container
    image: docker.elastic.co/kibana/kibana:6.6.0
    environment:
      - ELASTICSEARCH_HOSTS=http://es-container:9200
    networks:
      - es-net
    depends_on:
      - elasticsearch
    ports:
      - 5601:5601
networks:
  es-net:
    driver: bridge
```
- Description
	- Các phiên bản Kibana trước 5.6.15 và 6.6.1 chứa lỗ hổng thực thi mã tùy ý trong trình hiển thị Timelion. Kẻ tấn công có quyền truy cập vào ứng dụng Timelion có thể gửi yêu cầu cố gắng thực thi mã javascript. Điều này có thể dẫn đến việc kẻ tấn công thực thi các lệnh tùy ý với quyền của quy trình Kibana trên hệ thống máy chủ.
	![[Pasted image 20230306110855.png]]
- Theo mô tả ở trên chúng ta sẽ tập trung vào chức năng Timelion
	- Tìm hiểu một chút về các chức năng của Timelion theo link: [](https://www.elastic.co/guide/en/kibana/current/timelion.html)[https://www.elastic.co/guide/en/kibana/current/timelion.html](https://www.elastic.co/guide/en/kibana/current/timelion.html)
	- Ở đây ta thấy chỉ có một entrypoint là khung để gọi các hàm biểu thức (Timelion expression function). Bắt đầu bằng .es hay .elasticsearch sau đó là các hàm để tương tác với dữ liệu được truy vấn từ elastic search.
- Một điều nữa là khi đọc mô tả mình tìm thấy cụm từ prototype pollution. Với lại cũng vừa được anh minh cho làm một dạng này. Vì vậy mình xoáy sâu vào các payload liên quan đến prototype polution..
